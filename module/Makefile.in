
ifneq ($(KERNELRELEASE),)
	src := @module_root@
	obj-m := @CMAKE_PROJECT_NAME@.o
	ccflags-y += @module_ccflags@
	KBUILD_EXTRA_SYMBOLS := @module_symbols@
else

.PHONY: default reload unload load clean

default:
	$(MAKE) -C @kdir@ M=@module_output@ modules

clean:
	$(MAKE) -C @kdir@ M=@module_output@ clean

reload: unload load

unload:
	-rmmod @CMAKE_PROJECT_NAME@.ko

load:
	insmod @CMAKE_PROJECT_NAME@.ko

endif

